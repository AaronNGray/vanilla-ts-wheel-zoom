(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self,a.JcWheelZoom=b())})(this,function(){'use strict';var e=Math.min;function a(a){this.mouseUpHandler=this.mouseUpHandler.bind(this),this.mouseDownHandler=this.mouseDownHandler.bind(this),this.mouseMoveHandler=this.mouseMoveHandler.bind(this),this.scrollable=a,this.scrollable.addEventListener("mousedown",this.mouseDownHandler)}function b(a){var b=a.getBoundingClientRect(),c=document,d=c.body,e=c.documentElement,f=window.pageYOffset||e.scrollTop||d.scrollTop,g=window.pageXOffset||e.scrollLeft||d.scrollLeft,h=e.clientTop||d.clientTop||0,i=e.clientLeft||d.clientLeft||0,j=b.top+f-h,k=b.left+g-i;return{top:j,left:k}}function c(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function d(a,b){this._init=this._init.bind(this),this._prepare=this._prepare.bind(this),this._rescale=this._rescale.bind(this);this.image=document.querySelector(a),this.options=c({dragScrollable:!0,maxScale:1,speed:10},b),null!==this.image&&(this.window=this.image.parentNode,this.image.complete?this._init():this.image.onload=this._init)}return a.prototype={constructor:a,scrollable:null,coords:null,mouseDownHandler:function(a){return a.preventDefault(),1===a.buttons&&void(this.coords={left:a.clientX,top:a.clientY},document.addEventListener("mouseup",this.mouseUpHandler),document.addEventListener("mousemove",this.mouseMoveHandler))},mouseUpHandler:function(a){a.preventDefault(),document.removeEventListener("mouseup",this.mouseUpHandler),document.removeEventListener("mousemove",this.mouseMoveHandler)},mouseMoveHandler:function(a){a.preventDefault(),this.scrollable.scrollLeft-=a.clientX-this.coords.left,this.scrollable.scrollTop-=a.clientY-this.coords.top,this.coords={left:a.clientX,top:a.clientY}}},d.prototype={constructor:d,image:null,container:null,window:null,original:{image:{},window:{}},options:null,correctX:null,correctY:null,_init:function(){this.original.image={width:this.image.offsetWidth,height:this.image.offsetHeight},this.container=document.createElement("div"),this.window.appendChild(this.container),this.container.appendChild(this.image),this._prepare(),!0===this.options.dragScrollable&&new a(this.window),this.window.addEventListener("wheel",this._rescale),window.addEventListener("resize",this._rescale)},_prepare:function(){var a=Math.max;this.original.window={width:this.window.offsetWidth,height:this.window.offsetHeight};var b=e(this.original.window.width/this.original.image.width,this.original.window.height/this.original.image.height);this.correctX=a(0,(this.original.window.width-this.original.image.width*b)/2),this.correctY=a(0,(this.original.window.height-this.original.image.height*b)/2),this.image.width=this.original.image.width*b,this.image.height=this.original.image.height*b,this.image.style.marginLeft="".concat(this.correctX,"px"),this.image.style.marginTop="".concat(this.correctY,"px"),this.container.style.width="".concat(this.image.width+2*this.correctX,"px"),this.container.style.height="".concat(this.image.height+2*this.correctY,"px"),"function"==typeof this.options.prepare&&this.options.prepare(b,this.correctX,this.correctY)},_rescale:function(a){var c=Math.round;a.preventDefault();var d=0>a.deltaY?1:-1,f=this.image.width,g=this.image.height,h=f/this.original.image.width,i=e(this.original.window.width/this.original.image.width,this.original.window.height/this.original.image.height),j=h+d/this.options.speed;j=j<i?i:j>this.options.maxScale?this.options.maxScale:j;var k=this.window.scrollLeft,l=this.window.scrollTop,m=this.image.width=this.original.image.width*j,n=this.image.height=this.original.image.height*j,o=m+2*this.correctX,p=n+2*this.correctY;this.container.style.width="".concat(o,"px"),this.container.style.height="".concat(p,"px"),"function"==typeof this.options.rescale&&this.options.rescale(j,this.correctX,this.correctY,i);var q=this.window.scrollLeft,r=this.window.scrollTop,s=b(this.window),t=c(a.pageX-s.left+this.window.scrollLeft-this.correctX),u=c(m*t/f);this.window.scrollLeft+=u-t+(k-q);var v=c(a.pageY-s.top+this.window.scrollTop-this.correctY),w=c(n*v/g);this.window.scrollTop+=w-v+(l-r)},prepare:function(){this._prepare()},zoomUp:function(){var a=b(this.window),c=new Event("wheel");c.deltaY=-1,c.pageX=a.left+this.original.window.width/2,c.pageY=a.top+this.original.window.height/2,this._rescale(c)},zoomDown:function(){var a=b(this.window),c=new Event("wheel");c.deltaY=1,c.pageX=a.left+this.original.window.width/2,c.pageY=a.top+this.original.window.height/2,this._rescale(c)}},d.create=function(a,b){return new d(a,b)},d});